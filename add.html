<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" >
<head>
    <th:block th:include="include :: header('新增订单主表')" />
    <th:block th:include="include :: datetimepicker-css" />
    <style type="text/css">
        #show1,
        #show2 {
            display: none;
            border: 1px solid #f5f5f5;
            border-radius: 8px;
            padding: 24px;
        }
        .disflex{
            display: flex;
        }
        .middle{
            text-align: center;
            line-height: 34px;
            width: calc(16.66666667% - 15px);
        }
        .line34{
            line-height: 34px;
        }
        .price input{
            width: 50%;
            display: inline-block;
            margin-right: 20px;
        }
        .flex1{
            flex: 1;
        }
        .marleft{
            margin-left: 12px;
        }
        .btngroup{
            position: absolute;
            right: 20px;
            top: 50%;
            margin-top: -44px;
        }
        .btngroup button{
            display: block;
            margin-bottom: 20px;
            width: 110px;
        }
    </style>
</head>
<body class="white-bg">
    <div class="wrapper wrapper-content animated fadeInRight ibox-content">
        <form class="form-horizontal m" id="form-list-add">
            <div class="form-group">    
                <label class="col-sm-3 control-label " >项目名称：</label>
                <div class="col-sm-8">
                    <input name="ordName" class="form-control order_project_name"  type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label" >客户名称：</label>
                <div class="col-sm-8">
                    <input name="customerName" class="form-control order_customer_name" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label is-required">客户订单编号：</label>
                <div class="col-sm-8">
                    <input name="ordCode" class="form-control order_id" type="text" required>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label is-required">开始时间：</label>
                <div class="col-sm-8">
                    <div class="input-group date">
                        <input name="startTime" class="form-control order_start_time " placeholder="yyyy-MM-dd" type="text" required>
                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                    </div>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label is-required">结束时间：</label>
                <div class="col-sm-8">
                    <div class="input-group date">
                        <input name="endTime" class="form-control order_end_time" placeholder="yyyy-MM-dd" type="text" required>
                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                    </div>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">所需工时：</label>
                <div class="col-sm-5">
                    <input name="workload" class="form-control order_workload" type="text">
                </div>
                <div class="btn-group">
                    <button type="button" class="btn btn-primary dropdown-toggle btn-sm"
                            data-toggle="dropdown">
                        单位 <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu order_workload_unit" role="menu">
                        <li><a href="#">人天</a></li>
                        <li><a href="#">人月</a></li>
                    </ul>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">报价：</label>
                <div class="col-sm-8">
                    <input name="proPrice" class="form-control order_quotation" type="text">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label">报价单附件：</label>
                <div class="col-sm-8">
                    <input type="hidden" name="quoFile">
                    <div class="file-loading">
                        <input class="form-control file-upload order_quotation_sheet " id="quoFile" name="file" type="file">
                        <input type = "button" id = "btnSave" onclick = "uploadSubmi()" />
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label">项目合同附件：</label>
                <div class="col-sm-8">
                    <input type="hidden" name="proFile">
                    <div class="file-loading"> 
                        <input class="form-control file-upload order_project_sheet " id="proFile" name="file" type="file">
                        <input type = "button" id = "btnSave1" onclick = "uploadSubmit()" />
                    </div>
                </div>
            </div>

            <div style="width: 700px; margin: 0 auto;">
                <div class="checkbox">
                    <label><input type="checkbox" id="isOrder" class=" order_need_server" value="">是否需要订购服务器</label>
                </div>
                <div id="show1">
                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                            <label for="firstname" class="col-sm-2 control-label">服务器运营商:</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control order_server_operator" id="firstname" placeholder="">
                            </div>
                            <div class="col-sm-2">
                                <button type="button" class="btn btn-success">查看续费订单</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="lastname" class="col-sm-2 control-label">服务器配置:</label>
                            <div class="col-sm-8">
                                <textarea class="form-control order_server_options" rows="3"></textarea>
                            </div>
                        </div>
                        <div class="form-group disflex">
                            <label for="lastname" class="col-sm-2 control-label">起止时间:</label>
                            <div style="padding-left: 15px;" class='input-group date col-sm-3 order_server_start_time' id='datetimepicker1'>
                                <input type='text' class="form-control" />
                                <span class="input-group-addon">
								<span class="glyphicon glyphicon-calendar"></span>
							</span>
                            </div>
                            <div class="col-sm-2 middle">至</div>
                            <div class='input-group date col-sm-3' id='datetimepicker2'>
                                <input type='text' class="form-control order_server_end_time" />
                                <span class="input-group-addon">
								<span class="glyphicon glyphicon-calendar"></span>
							</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="firstname" class="col-sm-2 control-label">服务器报价:</label>
                            <div class="col-sm-8 price">
                                <input type="text" class="form-control order_server_price" id="firstname" placeholder=""><span>万元</span>
                            </div>
                            <div class="col-sm-2">
                                <div  class="btn btn-success order_server_renew">续费</div>
<!--                                <input type="file" class="btn btn-success" th:value="续费" name="file" onclick="renew()"/>-->
                        </div>
                        </div>
                    </form>
                </div>
                <div class="checkbox">
                    <label><input type="checkbox" id="isMaintain" class="order_server_maintain" value="">是否需要后期运营维护</label>
                </div>
                <div id="show2">
                    <form class="form-horizontal" style="position: relative;" role="form">
                        <div class="form-group">
                            <label for="firstname" class="col-sm-2 control-label">免费维护期:</label>
                            <div class="col-sm-4 disflex">
                                <input type="text" class="form-control flex1 order_server_maintain_free_time" id="firstname" placeholder=""><span class="line34 marleft">月</span>
                            </div>
                        </div>
                        <div class="form-group disflex">
                            <label for="lastname" class="col-sm-2 control-label">收费开始时间:</label>
                            <div style="padding-left: 15px;" class='input-group date col-sm-4' id='datetimepicker3'>
                                <input type='text' class="form-control order_server_maintain_charge_time" />
                                <span class="input-group-addon">
								<span class="glyphicon glyphicon-calendar"></span>
							</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="firstname" class="col-sm-2 control-label">维护费用:</label>
                            <div class="col-sm-4 disflex">
                                <input type="text" class="form-control flex1 order_server_maintain_charge" id="firstname" placeholder=""><span class="line34 marleft">元/月</span>
                            </div>
                        </div>
                        <div class="form-group disflex">
                            <label for="lastname" class="col-sm-2 control-label">续费至:</label>
                            <div style="padding-left: 15px;" class='input-group date col-sm-4' id='datetimepicker4'>
                                <input type='text' class="form-control order_server_maintain_end_time" />
                                <span class="input-group-addon">
								<span class="glyphicon glyphicon-calendar"></span>
							</span>
                            </div>
                        </div>
                        <div class="btngroup">
                            <button type="button" class="btn btn-success">查看续费订单</button>
                            <button type="button" class="btn btn-info order_server_maintain_renew">续费</button>
                        </div>
                    </form>
                </div>
            </div>
        </form>
    </div>
    <th:block th:include="include :: footer" />
    <th:block th:include="include :: datetimepicker-js" />
    <script th:inline="javascript">
        
        var renew = [ 
                        document.getElementsByClassName('order_server_renew')[0],
                        document.getElementsByClassName('order_server_maintain_renew')[0]
                    ];
        var ordreData = {};

        // 循环绑定点击事件
        for(var i = 0; i< renew.length; i++){
            var item = renew[i];
            (function(){
                item.addEventListener('click',function(){
                ordreData = {
                    'order_project_name':getDomValue('order_project_name'),// 项目名称
                    'order_customer_name':getDomValue('order_customer_name'),// 客户名称
                    'order_id':getDomValue('order_id'),// 客户订单编号
                    'order_start_time': getDomValue('order_start_time'), //项目开始时间
                    'order_end_time': getDomValue('order_end_time'), //项目结束时间
                    'order_workload': getDomValue('order_workload'), //项目所需工时
                    'order_quotation': getDomValue('order_quotation'), //项目报价
                };
                sessionStorage.setItem('orderData',JSON.stringify(ordreData));// 将数据存入session 
            },'false')
            })();
        };

        

        //// 获取元素value值
       function getDomValue(classname){
        console.log(document.getElementsByClassName(classname)[0].value);
            return document.getElementsByClassName(classname)[0].value;
       }


        var isorder = document.getElementById("isOrder");
        var ismaintain = document.getElementById("isMaintain");
        isOrder.onclick = function() {
            if (isOrder.checked) {
                document.getElementById("show1").style.display = 'block'
            } else {
                document.getElementById("show1").style.display = 'none'
            }
        }
        ismaintain.onclick = function() {
            if (ismaintain.checked) {
                document.getElementById("show2").style.display = 'block'
            } else {
                document.getElementById("show2").style.display = 'none'
            }
        }

        $(function() {
            $('#datetimepicker1').datetimepicker({
                format: 'YYYY-MM-DD', //显示年月日
                locale: moment.locale('zh-cn')
            });
            $('#datetimepicker2').datetimepicker({
                format: 'YYYY-MM-DD', //显示年月日
                locale: moment.locale('zh-cn')
            });
            $('#datetimepicker3').datetimepicker({
                format: 'YYYY-MM-DD', //显示年月日
                locale: moment.locale('zh-cn')
            });
            $('#datetimepicker4').datetimepicker({
                format: 'YYYY-MM-DD', //显示年月日
                locale: moment.locale('zh-cn')
            });
        });
        var prefix = ctx + "order/list"
        $("#form-list-add").validate({
            focusCleanup: true
        });

        function submitHandler() {
            if ($.validate.form()) {
                $.operate.save(prefix + "/add", $('#form-list-add').serialize());
            }
        }

        $("input[name='startTime']").datetimepicker({
            format: "yyyy-mm-dd",
            minView: "month",
            autoclose: true
        });

        $("input[name='endTime']").datetimepicker({
            format: "yyyy-mm-dd",
            minView: "month",
            autoclose: true
        });

        $("input[name='createDate']").datetimepicker({
            format: "yyyy-mm-dd",
            minView: "month",
            autoclose: true
        });

        $("input[name='modifyDate']").datetimepicker({
            format: "yyyy-mm-dd",
            minView: "month",
            autoclose: true
        });


        const orderData = JSON.parse(sessionStorage.getItem('orderData'));

    </script>
</body>
</html>